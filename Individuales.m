%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%% Programa para Concentraciones de Compuestos %%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% Autor: Felipe Pérez Vargas %%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% Universidad de Guanajuato %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clc
clear all
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                               Compuestos                               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
A=load('5mf.txt'); %max=274 nm                                           %%   
B=load('fur.txt'); %max=284 nm                                           %%
C=load('5hmf.txt'); %max=277 nm                                          %% 
D=load('2af.txt'); %max= 292 nm                                          %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%% Concentraciones %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
Co=[0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01]';        %%
w=[ones(size(Co)) Co]; %X                                                %%
%                                                                        %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%% Espectros de Absorción %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
subplot(1,2,1)                                                           %% 
P1=plot(A(:,1),A(:,2),'b',A(:,1),A(:,3),'b',...                          %%
    A(:,1),A(:,4),'b', A(:,1),A(:,5),'b',...                             %%
    A(:,1),A(:,6),'b',A(:,1),A(:,7),'b',...                              %%
     A(:,1),A(:,8),'b',A(:,1),A(:,9),'b',...                             %%
     A(:,1),A(:,10),'b',A(:,1),A(:,11),'b');                             %%  
 xlabel('Longitud de onda (nm)')                                         %%
 ylabel('Absorbancia (ua)')                                              %%
 legend('5-MF');                                                         %%
 title('5 Metil Furfural')                                               %%
 axis([245 325 0 1.7])                                                   %%
 set(P1,'linewidth',2);                                                  %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Curva de Calibración                           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
 a=zeros(10,1);                                                          %%
for i=1:10                                                               %%
a(i)=find(A(:,i+1)==max(A(:,i+1)));                                      %%
end                                                                      %%
am=round(mean(a));                                                       %%
%                                                                        %%
for j=2:11                                                               %%
 max(A(:,j));                                                            %%
end                                                                      %%
MaxA=[max(A(:,2)) max(A(:,3)) max(A(:,4)) max(A(:,5)) max(A(:,6))...     %%
    max(A(:,7)) max(A(:,8)) max(A(:,9)) max(A(:,10)) max(A(:,11))]';     %%
C5mf=[0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01]';      %%
%                                                                        %%
%                                                                        %%
subplot(1,2,2)                                                           %% 
 FIT1=polyfit(C5mf,MaxA,1);                                              %%
 CON=0:0.001:0.01;                                                       %%
 yp=polyval(FIT1,CON);                                                   %%
 subplot(1,2,2)                                                          %%
 C1=plot(C5mf,MaxA,'r+',CON, yp,'k');                                    %%
 xlabel('Concentración mg/100 mL')                                       %%
 ylabel('Absorbancia (ua)')                                              %% 
 title('5 Metil Furan')                                                  %% 
 legend('Concentraciones','Ajuste')                                      %%
 axis([0 0.01 0 1.7])                                                    %%
 set(C1,'linewidth',2);                                                  %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%              Coeficiente de extinción molar  2AF                       %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%                                                                        %% 
figure                                                                   %%
A(:,2:end)=A(:,2:end);                                               %%
epA=A(:,2:end)*Co./(Co'*Co); %(X'*X)^-1*(y'*X)                           %%
%epA1=(Co'*Co)^-1*A(:,2:end)*Co;                                         %%
C2af=plot(A(:,1),epA,'g');                                               %%
xlabel('Longitud de onda (nm)')                                          %%
ylabel('Absortividad molar')                                             %%  
title('5 Metil-Furan')                                                   %%
legend('Coeficiente de absorción 5MF')                                   %%
axis ([ 250 325 0 190 ])                                                 %% 
set(C2af,'linewidth',2);                                                 %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 

 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                        Normal + Smooth                                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

As=load('5mf.txt'); %max=274 nm


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Suavizado %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
for n=2:11                                                               %%
As(:,n)=smooth(As(:,n)); %y                                              %% 
end                                                                      %% 
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%% Espectros de Absorción %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   
subplot(1,2,1)                                                           %% 
P1s=plot(As(:,1),As(:,2),'b',As(:,1),As(:,3),'b',...                          %%
    As(:,1),As(:,4),'b', As(:,1),As(:,5),'b',...                             %%
    As(:,1),As(:,6),'b',As(:,1),As(:,7),'b',...                              %%
    As(:,1),As(:,8),'b',As(:,1),As(:,9),'b',...                             %%
    As(:,1),As(:,10),'b',As(:,1),As(:,11),'b');                             %%  
 xlabel('Longitud de onda (nm)')                                         %%
 ylabel('Absorbancia (ua)')                                              %%
 legend('5-MF');                                                         %%
 title('5 Metil Furfural')                                               %%
 axis([245 325 0 1.7])                                                   %%
 set(P1s,'linewidth',2);                                                  %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                         Curva de Calibración                           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
 as=zeros(10,1);                                                         %%
for i=1:10                                                               %%
as(i)=find(As(:,i+1)==max(As(:,i+1)));                                   %%
end                                                                      %%
asm=round(mean(as));                                                     %%
%                                                                        %%
for j=2:11                                                               %%
 max(As(:,j));                                                           %%
end                                                                      %%
MaxAs=[max(As(:,2)) max(As(:,3)) max(As(:,4)) max(As(:,5)) max(As(:,6))...     %%
    max(As(:,7)) max(As(:,8)) max(As(:,9)) max(As(:,10)) max(As(:,11))]';     %%
C2af=[0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 0.01]';      %%
%                                                                        %%
%                                                                        %%
subplot(1,2,2)                                                           %% 
 FIT1s=polyfit(C2af,MaxAs,1);                                             %%
 CON=0:0.001:0.01;                                                       %%
 yp=polyval(FIT1s,CON);                                                   %%
 subplot(1,2,2)                                                          %%
 C1s=plot(C2af,MaxAs,'r+',CON, yp,'k');                                   %%
 xlabel('Concentración mg/100 mL')                                       %%
 ylabel('Absorbancia (ua)')                                              %% 
 title('2 acetil furfural')                                              %% 
 legend('Concentraciones','Ajuste')                                      %%
 axis([0 0.01 0 1.7])                                                    %%
 set(C1s,'linewidth',2);                                                  %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%              Coeficiente de extinción molar  2AF                       %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%                                                                        %% 
figure                                                                   %%
As(:,2:end)=As(:,2:end);                                               %%
epAs=As(:,2:end)*Co./(Co'*Co); %(X'*X)^-1*(y'*X)                           %%
%epA1=(Co'*Co)^-1*A(:,2:end)*Co;                                         %%
C2afs=plot(As(:,1),epAs,'g');                                               %%
xlabel('Longitud de onda (nm)')                                          %%
ylabel('Absortividad molar')                                             %%  
title('2 Acetil-Furan')                                                  %%
legend('Coeficiente de absorción 2AF')                                   %%
axis ([ 250 325 0 190 ])                                                 %% 
set(C2afs,'linewidth',2);                                                 %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                   Normal-Noise                                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Ruido %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
%Mw=w'*w; %X'*X                                                           %%
%z=As(end,2:end);                                                          %%
%ywAs=w'*z';                                                               %%
%rAs=Mw^-1*ywAs;                                                            %%
%ruAs=rAs(1);                                                               %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%% Espectros de Absorción %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                        %%
%figure                                                                   %%
%subplot(1,2,1)                                                           %% 
%P2=plot(As(:,1),As(:,2)-ruAs,'g',As(:,1),As(:,3)-ruAs,'g',...            %%
%    As(:,1),As(:,4)-ruAs,'g', As(:,1),As(:,5)-ruAs,'g',...               %%
%    As(:,1),As(:,6)-ruAs,'g',As(:,1),As(:,7)-ruAs,'g',...                %%
%     As(:,1),As(:,8)-ruAs,'g',As(:,1),As(:,9)-ruAs,'g',...               %%
%     As(:,1),As(:,10)-ruAs,'g',As(:,1),As(:,11)-ruAs,'g');               %%  
% xlabel('Longitud de onda (nm)')                                         %%
% ylabel('Absorbancia (ua)')                                              %%
% legend('2-AF');                                                         %%
%title('2 Acetil Furan')                                                 %%
%axis([245 325 0 1.7])                                                   %%
%set(P2,'linewidth',2);                                                  %%
%                                                                        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 